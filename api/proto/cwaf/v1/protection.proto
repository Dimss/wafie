syntax = "proto3";

package cwaf.v1;


enum ProtectionType {
  PROTECTION_TYPE_UNSPECIFIED = 0;
  PROTECTION_TYPE_WAF = 1;
}

message Protection {
  ProtectionType type = 1;
  oneof protection_options {
    ModSecProtection modsec_protection = 3;
  }
}

message ModSecProtection {
  optional uint32 id = 1;
  optional uint32 application_id = 2;
}

message CreateProtectionRequest {
  Protection protection = 1;
}

message CreateProtectionResponse {
  uint32 id = 1;
}

message GetProtectionRequest {
  uint32 id = 1;
}

message GetProtectionResponse {
  Protection protection = 1;
}

message ListProtectionsRequest {
  uint32 application_id = 1;
}

message ListProtectionsResponse {
  repeated Protection protections = 1;
}

message PutProtectionRequest {
  Protection protection = 1;
}

message PutProtectionResponse {
  uint32 id = 1;
}

service ProtectionService {
  rpc CreateProtection(CreateProtectionRequest) returns (CreateProtectionResponse);
  rpc GetProtection(GetProtectionRequest) returns (GetProtectionResponse);
  rpc ListProtections(ListProtectionsRequest) returns (ListProtectionsResponse);
  rpc PutProtection(PutProtectionRequest) returns (PutProtectionResponse);
}
